# functions - functions for shirasagi-hardening
#
# Copyright(C) Shintaro Fujiwara

# creates log file in /root and logs what the script do 

mklog()
{
    sync >/dev/null 2>&1
    exec > >(tee $LOGFILE) 2>&1
}

# error message 

err_msg () {
    echo "Oops! Something went wrong!"
    exit 1
}

# check user is root 

check_root () {
    local myresult=""
    if [ ${EUID:-${UID}} = 0 ]; then
        myresult="root"
    else
        myresult="nonroot" 
    fi
    echo "${myresult}"
}

# check SELinux is enabled 

check_SELinux_is_enabled () {
    local myresult=""
    myresult=$(getenforce)
    echo "${myresult}"
}

# check rpms to be installed

check_rpms()
{
    local num=1
    RPMS_TO_BE_INSTALLED=()
    while [ $num -le $# ]; do
        local rpm_lacked=""
        local rpm_name=""
        rpm_name=$(eval echo "\$$num")
        #echo $rpm_name
        `rpm -q "${rpm_name}" >/dev/null`
        if [ $? -ne 0 ]; then
            rpm_lacked=$(echo "$rpm_name")
            RPMS_TO_BE_INSTALLED=("${RPMS_TO_BE_INSTALLED[@]}" "${rpm_lacked}")
        fi
        shift
    done
    echo "${RPMS_TO_BE_INSTALLED[@]}"
}
